"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");function t(e){const{state:t,acts:n}=e;let s=Object.assign({},t);const r=new Map,c=[],o=e=>{var t;"*"===e?r.forEach((e=>e.forEach((e=>e())))):(e.forEach((e=>{var t;return null===(t=r.get(e))||void 0===t?void 0:t.forEach((e=>e()))})),null===(t=r.get("*"))||void 0===t||t.forEach((e=>e())))};function u(e){return void 0!==e?s[e]:s}const a=e=>{const t=Object.assign({},s),n="function"==typeof e?e(t):e;let r=Object.assign(Object.assign({},s),n);for(const e of c){const n=e(t,r);void 0!==n&&(r=n)}const u=[];for(const e in r)Object.prototype.hasOwnProperty.call(r,e)&&s[e]!==r[e]&&u.push(e);u.length&&(s=r,o(u))},i={};if(Array.isArray(n))for(const e of n){const t=e.call(i,u,a);t&&"object"==typeof t&&Object.assign(i,t)}else if("function"==typeof n){const e=n.call(i,u,a);e&&"object"==typeof e&&Object.assign(i,e)}for(const e of Object.keys(i)){const t=i[e];"function"==typeof t&&(i[e]=t.bind(i))}return{get:u,set:a,reset:function(...e){if(0===e.length)s=Object.assign({},t),o("*");else{const n={};for(const s of e)s in t&&(n[s]=t[s]);s=Object.assign(Object.assign({},s),n),o(e)}},subscribe:(e,t)=>{if(0===t.length)return()=>{};const n=()=>e(s);return"*"===t[0]?(r.has("*")||r.set("*",new Set),r.get("*").add(n),()=>{var e;return null===(e=r.get("*"))||void 0===e?void 0:e.delete(n)}):(t.forEach((e=>{r.has(e)||r.set(e,new Set),r.get(e).add(n)})),()=>{t.forEach((e=>{var t;return null===(t=r.get(e))||void 0===t?void 0:t.delete(n)}))})},middleware:e=>{c.push(e)},acts:i}}function n(n){const s=()=>{const[,t]=e.useReducer((()=>({})),{});return t},r=t(n);return Object.assign(Object.assign({},r),{use:function(t){return e.useSyncExternalStore((e=>r.subscribe(e,t?[t]:["*"])),(()=>t?r.get(t):r.get()))},useRerender:s,useSelector:function(t,n){const c=s(),o=e.useRef(t(r.get()));return e.useEffect((()=>{const e=e=>{const n=t(e);n!==o.current&&(o.current=n,c())},s=r.subscribe(e,n);return e(r.get()),s}),[t,n.join()]),o.current}})}function s(e){return function(t,n){return e.call(this,t,n)}}const r={createNexus:t,createReactNexus:n,createActs:s};exports.createActs=s,exports.createNexus=t,exports.createReactNexus=n,exports.default=r;
