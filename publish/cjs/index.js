"use strict";var t=require("react");function e(t){const{state:e,actions:n}=t;let s=Object.assign({},e);const r=new Map,c=[],o=t=>{var e;"*"===t?r.forEach((t=>t.forEach((t=>t())))):(t.forEach((t=>{var e;return null===(e=r.get(t))||void 0===e?void 0:e.forEach((t=>t()))})),null===(e=r.get("*"))||void 0===e||e.forEach((t=>t())))},u=t=>{const e=Object.assign({},s),n="function"==typeof t?t(e):t;let r=Object.assign(Object.assign({},s),n);for(const t of c){const n=t(e,r);void 0!==n&&(r=n)}const u=[];for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&s[t]!==r[t]&&u.push(t);u.length&&(s=r,o(u))},a={getNexus:function(t){return void 0!==t?s[t]:s},setNexus:u,nexusReset:()=>{s=Object.assign({},e),o("*")},nexusSubscribe:(t,e)=>{const n=Array.isArray(t)?t:[t];return n.forEach((t=>{r.has(t)||r.set(t,new Set),r.get(t).add(e)})),()=>{n.forEach((t=>{var n;return null===(n=r.get(t))||void 0===n?void 0:n.delete(e)}))}},nexusGate:t=>{c.push(t)}},i={};if(Array.isArray(n))for(const t of n){const e=t.call(i,u);e&&"object"==typeof e&&Object.assign(i,e)}else if("function"==typeof n){const t=n.call(i,u);t&&"object"==typeof t&&Object.assign(i,t)}for(const t of Object.keys(i)){const e=i[t];"function"==typeof e&&(i[t]=e.bind(i))}return{state:a,actions:i}}exports.createActions=function(t){return function(e){return t.call(this,e)}},exports.createDiscreteActions=function(t){return function(e){return t.call(this,e)}},exports.createReactStore=function(n){const{state:s,actions:r}=e(n),c=r;return{state:Object.assign(Object.assign({},s),{useNexus:function(e){return t.useSyncExternalStore((t=>s.nexusSubscribe(e?[e]:"*",t)),(()=>{const t=s.getNexus();return e?t[e]:t}))},useNexusSelector:function(e,n){const r=t.useRef(e(s.getNexus())),[c,o]=t.useState(r.current);return t.useEffect((()=>{const t=()=>{const t=e(s.getNexus());t!==r.current&&(r.current=t,o(t))},c=s.nexusSubscribe(n,t);return t(),c}),[n,e]),c},useUpdate:()=>{const[,e]=t.useReducer((()=>({})),{});return e}}),actions:c}},exports.createStore=e;
