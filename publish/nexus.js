"use strict";var e=require("react/jsx-runtime"),t=require("react");function n(e,n){const r=function(e){let n=e;const r=t.useRef(new Set);return{get:t.useCallback((()=>n),[]),set:t.useCallback((e=>{n=Object.assign(Object.assign({},n),e),r.current.forEach((e=>e()))}),[]),subscribe:t.useCallback((e=>(r.current.add(e),()=>r.current.delete(e))),[])}}(e);return{get:function(n){return n in r.get()||console.error(`State "${String(n)}" in useNexus not found ðŸ‘º`),t.useSyncExternalStore(r.subscribe,(()=>{var t;return null!==(t=r.get()[n])&&void 0!==t?t:e[n]}),(()=>e[n]))},dispatch:function(e){const t=r.get(),s=n(t,e);t!==s&&r.set(s)},getAll:function(){return t.useSyncExternalStore(r.subscribe,r.get,(()=>e))},selector:function(n){const s=r.get();return void 0===n(s)&&console.error("State in useNexusSelect not found ðŸ‘º"),t.useSyncExternalStore(r.subscribe,(()=>n(r.get())),(()=>n(e)))},subscribe:r.subscribe}}const r=t.createContext(null);let s=null;function u(){const e=t.useContext(r);if(!e)throw new Error("NexusProvider not found ðŸ‘º");return e}exports.NexusProvider=({initialStates:t,initialFuncs:u,children:i})=>{const o=function(e){return function t(n,r,s){if(Array.isArray(r.payload)&&!s)return r.payload.reduce(((e,n)=>t(e,n,!0)),n);const{stateKey:u,payload:i,type:o}=r;if(u){const e=n[u],t="function"==typeof i?i(e):i;if(t!=e)return Object.assign(Object.assign({},n),{[u]:t})}if(o){const t=e[o];(null==t?void 0:t.fData)&&t.fData(i)}return n}}(u||{}),c=structuredClone(t),a=Object.assign(Object.assign({},n(c,o)),{initialStates:t});return s=a.dispatch,e.jsx(r.Provider,{value:a,children:i})},exports.nexusEffect=function(e){if(!s)throw new Error("nexusEffect is not initialized. Make sure NexusProvider is used ðŸ‘º");s({payload:Array.isArray(e)?e:[e]})},exports.nexusUpdate=function(e){if(!s)throw new Error("nexusEffect is not initialized. Make sure NexusProvider is used ðŸ‘º");if("_NEXUS_"in e){const t=e._NEXUS_;s({payload:Object.keys(t).map((e=>({stateKey:e,payload:t[e]})))})}else{const t=Object.entries(e).map((([e,t])=>({stateKey:e,payload:t})));s({payload:t})}},exports.useNexus=function(e){const t=u();return e?t.get(e):t.getAll()},exports.useNexusSelect=e=>e(u().getAll());
